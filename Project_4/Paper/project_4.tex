\documentclass[%
reprint,nofootinbib,
amsmath,amssymb,
aps,
]{revtex4-1}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage[utf8]{inputenc}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{physics}
\usepackage{booktabs}
\usepackage{float}
\usepackage[bottom]{footmisc}
\usepackage{scrextend}
\bgroup
\def\arraystretch{1.3}
\newcommand{\HRule}{\rule{\textwidth}{0.5mm}}
\makeatletter
\newcommand*{\rom}[1]{\expandafter\@slowromancap\romannumeral #1@}
\makeatother

\begin{document}
\onecolumngrid

\begin{center}
	\large\textbf{The Ising Model\\ \small{Studies of phase transitions in magnetic systems}}
\end{center}
\vspace{5mm}

\begin{center}
	\small{$^1$ Oline A. Ranum}\\
\end{center}

\begin{center}
	\small{$^1$ University of Oslo, Institute of physics, 
		olinear@student.matnat.uio.no}
\end{center}

\begin{center}
	\textit{\today}
\end{center}
\vspace{7mm}
\noindent 
\HRule \vspace{2mm}\\
The main objective of this paper is to 
\vspace{1.5mm}  \\
\HRule
\vspace{0.3cm}

\twocolumngrid 
\section{Introduction}
The Icing model was first developed
The Icing model describes
I first present theory 

The Icing model has been extremely popular, with applications spanning from studies of phase transitions to simulations in statistics. 
 \newpage. \newpage 
\section{Theory} \noindent 
\subsection{The Ising model} \noindent 
The Ising model is a ferromagnetic model consisting of discrete variables that represent magnetic dipole moments of atomic spin, tha is suitable for studies of phase transitions at finite temperatures. For a given critical temperature, the Ising model exhibits a phase transition from a magnetic phase to a phase with zero magnetization. The model is therefor a binary system where the objects at each lattice site can only take two values, for instance -1 and 1. In one or two dimensions the Ising model has analytical solutions to several expectation values and it gives a qualitatively good understanding of several types of phase transitions. \\ \indent 
In its simplest form the Ising model describes the energy of a specified system configuration as  
\begin{equation}\label{isemodel}
	E = -J\sum_{\expval{kl}}^{N}s_ks_l -\Lambda \sum_{k}^{N} s_k
\end{equation}
where $s_k = \pm 1$, N is the total number of spin and $J$ is a coupling constant expressing the strength of the interaction between neighboring spins. The formulation $\expval{kl}$ indicates that we sum over nearest neighbors only. The parameter $\Lambda$ is an external magnetic field interacting with the magnetic moment set up by the spins. The last contribution is omitted when there is no externally applied field.\\ \indent 
For a ferromagnetic ordering $J> 0$, meaning it is energetically favorable for neighboring spins to be aligned. It is a feature that for significantly low temperatures leeads to a cooperative phenomenon called spontaneous magnetization. In other words, through interactions between nearest neighbors, a given magnetic moment can influence tha alignment of spins that are separated from the given spin by a macroscopic distance. The magnetisation in such a system can be modeled as the sum over all spins for a given configuration $i$
\begin{equation}\label{mf}
M_i = \sum_{j = 1}^{N}s_j
\end{equation}

\subsection{Periodic boundary conditions} \noindent 
For small systems, the way that the boundaries of the system are treated has an effect on the calculations. Periodic boundary conditions implies that the neighbor to the right of value $s_N$ is assumed to take the value of $s_1$, or equivalently that the neighbor to the left of $s_1$ takes the value $s_N$. 


\subsection{Thermodynamical systems} \noindent 
Finite, quantized systems with discrete properties will in general have a finite set of possible configurations $i$. Systems where the temperature for such a system is held constant, it is describable by the standard relations of Boltzmann statistics. I. e. the ensemble of micro state at any given temperature has the probability distribution \vspace{1mm}
\begin{equation}
P_i(\beta) = \dfrac{e^{-\beta E_i}}{Z}
\end{equation}  \vspace{1mm}
where $\beta^{-1} = kT$ with $k$ being the Boltzmann constant, T the temperature of the system and $E_i$ the energy of the microstate $i$. It follows that the partition function for the canonical ensemble is defined by\vspace{1mm}
\begin{equation}\label{pf}
	Z = \sum_{i = 1}^{M}e^{-\beta E_i}
\end{equation}\vspace{1mm}
where M is the number of micro-states $i$. In general, such a system will have properties $X$ who's moments follow \vspace{1mm}
\begin{equation}
	\expval{X} = \dfrac{1}{Z}\sum_iX_ie^{-\beta E_i}
\end{equation}\vspace{1mm}
In case of the expectation value of the energy, the following formula is also useful\vspace{1mm}
\begin{equation}\label{ev}
 \expval{E} = -\dfrac{\partial\ln Z}{\partial\beta}
\end{equation}\vspace{1mm}
The specific heat capacity $C_V$ of a system would be \vspace{1mm}
\begin{equation}\label{cv}
C_V = \dfrac{\beta}{T}\qty[\expval{E^2}-\expval{E}^2]
\end{equation}\vspace{1mm}
and the susceptibility \vspace{1mm}
\begin{equation}\label{chi}
\chi = \dfrac{\beta}{T}\qty(\expval{M^2}- \expval{M}^2) \vspace{1mm}
\end{equation} 
\hspace{6.cm}[M. Jensen, 2015]


\subsection{Ising model on 2x2 grid} \noindent 
For small systems, the boundary conditions matter. In the following it is assumed that the system is on a $2\times2$ lattice, with periodic boundary conditions. The arrangement of such a system is illustrated in figure \ref{si}, where each individual spin $s_i$ can either be up or down. \\ 
\begin{figure}
	\includegraphics[width = \columnwidth]{si.jpg}
	\caption{Illustration of the possible spin-configurations of the $2\times 2$ Ising model. Each individual spin $i$ can either be up or down.\label{si}}
\end{figure}
For a $2\times 2$ grid there exist $2^4 = 16$ different configurations. Various relevant properties of the $2\times 2$ system are presented below. Here, the quantities are simply presented, whereas their full derivation can be found in the appendix. The analytical partition function for this system 
\begin{equation} \vspace{1mm}
	Z =  4\cosh(8J\beta) + 12 
\end{equation} \vspace{1mm}
The energy expectation values are \vspace{1mm}
\begin{align}\label{E}
	\expval{E} = -\dfrac{32J}{z}\sinh(8J\beta)
\end{align}\vspace{1mm}
\begin{align}\label{E2}
	\expval{E^2} = \dfrac{258J^2}{Z}\cosh(8J\beta)
\end{align}\vspace{1mm}
It follows from equation \ref{cv} that \vspace{1mm}
\begin{align} \label{CV}
	C_V= \dfrac{\beta}{T}64J^2\qty[\dfrac{\cosh(8J\beta)}{\cosh(8J\beta) + 3}  -\qty(\dfrac{\sinh(8J\beta)}{\cosh(8J\beta) + 3 })^2]\nonumber  \\&\nonumber \\
\end{align}\vspace{1mm}
The magnetization expectation values becomes \vspace{1mm}
\begin{align} \label{exM}
	\expval{M} =  0
\end{align}\vspace{1mm}
\begin{align} \label{absM}
\expval{\abs{M}} =  \dfrac{2e^{8J\beta}}{\cosh(8J\beta) + 3 }
\end{align}\vspace{1mm}
\begin{align}\label{M2}
\expval{M^2} = \dfrac{8e^{8J\beta} + 8}{\cosh(8J\beta) + 3}
\end{align}\vspace{1mm}
Then, according to equation \ref{chi} the susceptibility is \vspace{1mm}
\begin{align}\label{CHI}
	\chi = \dfrac{\beta}{T}\dfrac{8e^{8J\beta} + 8}{\cosh(8J\beta) + 3}
\end{align}
----------------------------------\\
Probability transition rate:
\begin{equation}
	P_i = e^{-\beta\Delta E}
\end{equation}

\subsection{The metropolis algorithm}
\newpage
\section{Method} \noindent 
\subsection{A} \noindent 
Initially, a grid consisting of $2\times 2$ spins are considered with periodic boundary conditions. The systems analytical expectation values and properties are calculated using equation \ref{E}-\ref{CHI}. These calculations are used as benchmark calculations for the following numerical estimates, and are presented in table \ref{bc}.

\subsection*{B. Initial evaluation of the Ising Model and MC Cycles}
The Ising model with $J=1$ is employed in order to evaluate an $L\times L$ lattice of up- and down spins, and subjected to a Monte Carlo Metropolis procedure. The procedure is implemented as following:\\
The number of grid points $L^2$, the number of Monte Carlo Cycles $N$ and the set temperature $T$ is read from text files. Two system configurations are initiated, one contains spins of random orientations and the other spins in a configuration corresponding to the ground state. That is, all spins align, pointing either upwards or downwards. The former is employed in the current evaluation. \\
The energy and magnetization of the initial spin configuration is calculated, and an iteration process over the $N$ Monte Carlo iterations are initiated. For each Monte Carlo Cycle, two random indices are drawn from a Mersenne Twister 19937 generator. Then, the change in energy from doing the spin flip of the random spin is evaluated. If the change of spin yields a lower energy, the transition to the new configuration is preformed. If transitions yields a higher energy, a random number is drawn from a normal distribution of numbers $i\in[0,1]$ by the Mersenne Twister. If the random number is lower than the probability rate of equation \ref{probrate}, the transition is also made. When a transition is preformed, the energy and magnetization of the system is reevaluated. In all other cases, the transition is not preformed and the configuration with it's properties are conserved. \\ \indent 
From the energy and magnetization values the expectation values of $E$, $E^2$, $M$, $M^2$ and $\abs{M}$ are calculated by summing over all simulated values of $E$ and $M$ weighted by the number of Monte Carlo Cycles, after an initial burn-in time. The burn-in time is set to $t_{burn} = 0.005*N$. Then $C_V$ and $\chi$ is estimated using equation  \ref{cv} and \ref{chi}, for T = 1.0K and $k_b=1$. The expectation values and properties are weighted with the number of spins in the system, to yield the property values per spin. This procedure is initially preformed for a $2\times 2$ lattice through a set  of 10 independent runs per $N=10^i$ where $i = 4, 5, 6, 7, 8$. The results are compared to the benchmark values, and presented in table \ref{bc}.
\subsection*{Evaluation of most likely state} \noindent 
After the initial analysis the number of Monte Carlo iterations iterations to reach the most likely state are considered. Using the number of Monte Carlo iterations as an evolution axis, the expectation values are estimated as a function of $N$. The evaluation is preformed for both $\expval{E}$ and $\expval{\abs{M}}$ for both $T = 1.0$K and $T = 2.4$K. The number of accepted iterations as a function of $N$ is also plotted for both temperatures. The evaluations are preformed through 10 independent runs, and provided with the variance as error bars. Furthermore, the evaluation is preformed for all cases with the initial configuration being random and ordered with all spins up. An estimate for the equilibration time is provided based on an graphical evaluation. 

\subsection*{Analysis of the probability distribution} \noindent
The probability distribution $P(E)$ is estimated by counting up the numbers of times a given energy appears in the computations, for both temperatures. The burn-in time is now set to $t_{burn} = 5000L^2$. The results are presented using the \textit{seaborn kde-based distplot} histograms. The results are compared with the computed variance in energy $\sigma_E^2$.

\subsection{Numerical studies of phase transitions}
In order to study the behavior of the Ising model in two dimensions close to the critical temperature as a function of the lattice size $L\times L$, $\expval{E}$, $\expval{\abs{M}}$, $C_V$ and $\chi$ as functions of temperature. The properties are calculated for $T\in[2.15,2.5]$K with step interval $dT = 0.01$K for $L\in[40, 60, 80, 100]$. The result are compared to the analytical value of the critical temperature, $T_c$. The code is parallelized using MPI on four processors. An analysis of the time is preformed using various optimization flags. \\ 
In the end, an estimate of the critical temperature is extracted based on the previous results, using equation \ref{label}, and compared to the exact result of Lars Onsager. 
 
\newpage 
\onecolumngrid
\section{Results} 
\twocolumngrid
\vspace{4mm}

\subsection*{2$\times$2 Ising Model} \noindent 
The results of estimating a $2\times 2$ Ising model Monte Carlo simulation with the Metropolis algorithm is presented in table \ref{2b}. It is evident that some of the properties converge to the analytical values to a various degree as a function of $N$. It appears that approximately $N=10^7$ is sufficient to make a decent approximation to the analytical values. \\ \indent 
The results of the Monte Carlo Metropolis approach to estimating the expectation values are plotted in figure \ref{4C11}. It is evident that for both temperatures, in the case where the system was initiated in the ground state, the expectation values are much more consistent with the analytical values than the system initiated with a random configuration. The system appears to be converging faster for $T = 2.4$K, than for $T = 1.0$K. The expectation value for the energy appears to converge towards $\expval{E} = -2$ and the magnetization to $\expval{\abs{M}} = 1.0$.\\ \noindent 
It is furthermore clear that the evaluation fluctuates more for the system initiated with the random configurations, but that in both cases for sufficiently large $N$-values the variance goes to zero. 
\vspace{2mm}
\begin{table}[!h]
	\caption{\label{2b}Results per spin of a Metropolis Algorithm using the Ising model on a $2\times 2$ spin system, as a function of N. The analytical expectation values are given at the bottom of the table as A. }
	\begin{tabular}{|c|c|c|c|c|c|c|c|} \hline 
		\textbf{N}  & \hspace{1mm}	$\expval{\mathbf{E}}$ \hspace{1mm} & \hspace{1mm}$\expval{\mathbf{E^2}}$ \hspace{1mm} & \hspace{1mm}	$\expval{\mathbf{M}}$\hspace{1mm}  &	\hspace{1mm} $\expval{\mathbf{M^2}}$ \hspace{1mm}  &	\hspace{1mm}$\expval{\abs{\mathbf{M}}} $\hspace{1mm} & \hspace{2mm}$\mathbf{\chi}$	\hspace{2mm} & \hspace{2mm}	\textbf{C}$_V$\hspace{2mm} \\ \hline 
		&&&&&&&\\
		10$^4$   &  -1.9974   & 15.9793  &  0.6353 &   3.9958 &   0.9992&   0.0207 &   1.7822\\
		10$^5$    &          -1.9967   & 15.9739  &  -0.0309 &   3.9946 &   0.9989&   0.0260 &   3.7958\\ 
		
		10$^6$  &          -1.9958   & 15.9667  &  -0.0351 &   3.9931 &   0.9986&   0.0332 &   3.9452\\ 
		
		10$^7$  &          -1.9960   & 15.9680  &  -0.0037 &   3.9933 &   0.9987&   0.0320 &   3.9897\\ 
		10$^8$   &          -1.9960   & 15.9678  &  -0.0015 &   3.9933 &   0.9987&   0.0321 &   3.9931\\ 
		&&&&&&&\\ \hline 
		A &-1.9960 & 16.0926  &0.    &  3.9933 & 0.9980  & 0.0321&  3.9933 \\ \hline 
	\end{tabular}
\end{table} 

\newpage

\subsection{4C}
\onecolumngrid
\begin{figure*} 
	\includegraphics[width = \textwidth]{Figures/4C1.png} 
	\caption{\centering \label{4C11}Average energy and magnetization per spin as function of Monte Carlo iterations. The error bars represents the standard deviation of 10 independent test runs. \vspace{13mm}}
\end{figure*}
\twocolumngrid
\newpage
The equilibration time $t_{eq}$, or the number of Monte Carlo iterations needed to reach this equilibrium position, is roughly $10^7$ iterations.  


\begin{figure*} 
	\includegraphics[width = \textwidth]{Figures/Plot2.png} 
	\caption{\centering \label{4C1}Average energy and magnetization per spin as function of Monte Carlo iterations. The errorbar represents the standard deviation of 10 independent test runs.}
\end{figure*}

\begin{figure*} 
	\includegraphics[width = \textwidth]{Figures/Plot3.png} 
	\caption{\centering \label{4C1}Average energy and magnetization per spin as function of Monte Carlo iterations. The errorbar represents the standard deviation of 10 independent test runs.}
\end{figure*}
\newpage.
\newpage.
\newpage.
\section{Discussion} \noindent 
\section{Conclusion} \noindent 
\newpage . \newpage
\onecolumngrid 
\section{References} \noindent
\newpage
\section{Appendix} \noindent
\subsection{Derivation of thermo-physical quantities for a $2\times 2$ lattice grid}
Each energy state for the various configurations are determined by equation \ref{isemodel}, who for the specific $2\times2$ lattice grid is
\begin{align*}
E_i  =& -J[s_1s_2 + s_1s_3 + s_2s_1+s_2s_4+s_4s_2+s_4s_3 + s_3s_1 + s_3s_4] \nonumber \\
= &-2J[s_1s_2 + s_2s_3 + s_3s_4 + s_4s_1]
\end{align*}\vspace{1mm} 
One can use this relation to estimate the analytical partition function \footnote{By identity: $2\cosh(\alpha) = e^{-\alpha} + e^{\alpha}$}
\begin{align*}
Z = \sum_{i = 1}^{16}e^{2J\beta[s_1s_2 + s_2s_3 + s_3s_4 + s_4s_1]}
=&  2e^{-8J\beta} + 2e^{8J\beta} + 12e^0\nonumber \\
= & 4\cosh(8J\beta) + 12 
\end{align*} 
Using equation \ref{ev} it is evident that the energy expectation value for the system becomes 
\begin{align*}
\expval{E} = -\dfrac{\partial ln Z}{\partial \beta} = -2\dfrac{\partial}{\partial \beta}\ln{[e^{-8J\beta} + e^{8J\beta}]} =& -\dfrac{16J}{Z}[e^{8J\beta} - e^{-8J\beta}] \\ 
& = -\dfrac{32J}{z}\sinh(8J\beta)
\end{align*}
Table \ref{bc} shows all configurations and their corresponding energy $E_i$ and magnetization $M_i$

\begin{table}[!h]
	\caption{\label{bc} The 16 configurations for a $2\times 2$ Ising model on a 2D lattice. The energy $E_i$ and magnetization $M_i$ for each configuration $i$ is provided.}
	\begin{tabular}{|c|c|c|c|} \hline 
		S$_i$&S$_\uparrow$ & \textbf{$E_i$} [J]&$ M_i$ [\#] \\ \hline   
		0& $\uparrow\uparrow\uparrow\uparrow$ &-8J&4\\
		1&$\uparrow\uparrow\uparrow\downarrow$ & 0&2\\
		2&$\uparrow\uparrow\downarrow\uparrow$ &0&2\\
		3&$\uparrow\downarrow\uparrow\uparrow$ &0&2\\
		4&$\downarrow\uparrow\uparrow\uparrow$ &0&2\\
		5&$\uparrow\uparrow\downarrow\downarrow$ &0&0\\
		6&$\downarrow\downarrow\uparrow\uparrow$ &0&0\\
		7&$\uparrow\downarrow\uparrow\downarrow$ &0&0\\
		8&$\downarrow\uparrow\downarrow\uparrow$ &0&0\\
		9&$\downarrow\uparrow\uparrow\downarrow$ &8J&0\\
		10&$\uparrow\downarrow\downarrow\uparrow$ &8J&0\\
		11&$\uparrow\downarrow\downarrow\downarrow$ &0&-2\\
		12&$\downarrow\uparrow\downarrow\downarrow$ &0&-2\\
		13&$\downarrow\downarrow\uparrow\downarrow$ &0&-2\\
		14&$\downarrow\downarrow\downarrow\uparrow$ &0&-2\\
		15&$\downarrow\downarrow\downarrow\downarrow$ &-8J&-4\\\hline 
	\end{tabular}
\end{table}


The specific heat capacity of this system can be calculated using equation $cv$, 
\begin{align}
\expval{E^2} = \dfrac{1}{Z}\sum_{i=1}^{16}E_ie^{-\beta E_i}  = & \dfrac{128J^2}{Z}(e^{8J\beta} + e^{-8J\beta}) \\
=& \dfrac{258J^2}{Z}\cosh(8J\beta)
\end{align}
It follows that 
\begin{align}
C_V =& \dfrac{\beta}{T}\qty[\dfrac{258J^2\cosh(8J\beta)}{4\cosh(8J\beta) + 12 }  -\qty(-\dfrac{32J\sinh(8J\beta)}{4\cosh(8J\beta) + 12 })^2] \nonumber \\
= & \dfrac{\beta}{T}64J^2\qty[\dfrac{\cosh(8J\beta)}{\cosh(8J\beta) + 3}  -\qty(\dfrac{\sinh(8J\beta)}{\cosh(8J\beta) + 3 })^2]\nonumber \\ \nonumber & \\ & 
\end{align}
The mean magnetization becomes 
\begin{align*}
\expval{M} =& \dfrac{1}{Z}\sum_{i = 1}^{16} M_ie^{-\beta E_i} \\ 
= & \dfrac{1}{Z}\qty(4e^{8J\beta} +4\times 2e^0 + 4\times(-2)e^0 -4e^{8J\beta}) \\
= & 0
\end{align*}
\begin{align*}
\expval{\abs{M}} =& \dfrac{1}{Z}\sum_{i = 1}^{16} \abs{M_i}e^{-\beta E_i} \\ 
= & \dfrac{1}{Z}\qty(4e^{8J\beta} +4\times 2e^0 + 4\times2e^0 +4e^{8J\beta}) \\
= & \dfrac{8e^{8J\beta}}{4\cosh(8J\beta) + 12 } \\
= & \dfrac{2e^{8J\beta}}{\cosh(8J\beta) + 3 }
\end{align*}
\begin{align*}
\expval{M^2} =& \dfrac{1}{Z}\sum_{i = 1}^{16} M_i^2e^{-\beta E_i} \\ 
= & \dfrac{1}{Z}\qty(16e^{8J\beta} +4\times 4e^0 + 4\times4e^0 + 16e^{8J\beta}) \\
= & \dfrac{8e^{8J\beta} + 8}{\cosh(8J\beta) + 3}
\end{align*}
Yielding the susceptibility 
\begin{align}
\chi =& \dfrac{\beta}{T}\qty(\expval{M^2}- \expval{M}^2)\\
=& \dfrac{\beta}{T}\dfrac{8e^{8J\beta} + 8}{\cosh(8J\beta) + 3}
\end{align}

 
\end{document}